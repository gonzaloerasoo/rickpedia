<section class="section-header">
  <h2>Localizaciones</h2>
  <p>Explora los mundos y dimensiones del universo de Rick y Morty.</p>
</section>

<div class="filter-toggle">
  <button (click)="showFilterPanel = true">
    <span class="material-icons">tune</span> Filtros
  </button>
</div>

@if (showFilterPanel) {
<div class="filter-panel">
  <div class="panel-header">
    <h3>Filtros</h3>
    <button (click)="showFilterPanel = false">
      <span class="material-icons">close</span> Cerrar
    </button>
  </div>

  <div class="panel-body">
    <mat-form-field appearance="fill" color="accent" class="name-field">
      @if (!showNameOverlay) {
      <mat-label>Nombre de la localización</mat-label>
      }
      <input
        matInput
        [formControl]="locationName"
        (focus)="onNameFocus()"
        (blur)="onNameBlur()"
      />
      @if (showNameOverlay) {
      <div class="static-text">Nombre de la localización</div>
      }
    </mat-form-field>

    <mat-form-field appearance="fill" color="accent" class="name-field">
      @if (!showCharacterOverlay) {
      <mat-label>Nombre de personaje</mat-label>
      }
      <input
        matInput
        [formControl]="characterName"
        (focus)="onCharacterFocus()"
        (blur)="onCharacterBlur()"
      />
      @if (showCharacterOverlay) {
      <div class="static-text">Nombre de personaje</div>
      }
    </mat-form-field>
  </div>
</div>
}

<div class="card-grid">
  @for (loc of paginatedLocations; track loc.id) {
  <a class="character-card episode-link" [routerLink]="['/locations', loc.id]">
    <div class="card-content">
      <h3 class="name">{{ loc.name }}</h3>
      <p class="meta">
        {{ loc.type || "Sin tipo" }} <span class="separator">–</span>
        {{ loc.dimension || "Sin dimensión" }}
      </p>
    </div>
  </a>
  }
</div>

<div class="pagination-controls">
  <button (click)="prevPage()" [disabled]="currentPage === 1">Anterior</button>

  <button (click)="goToPage(1)" [class.active]="currentPage === 1">1</button>

  @if (showPrevEllipsis) {
  <button (click)="handlePrevEllipsis()">...</button>
  } @for (page of visiblePageNumbers; track page) {
  <button (click)="goToPage(page)" [class.active]="page === currentPage">
    {{ page }}
  </button>
  } @if (showNextEllipsis) {
  <button (click)="handleNextEllipsis()">...</button>
  } @if (totalPages > 1) {
  <button
    (click)="goToPage(totalPages)"
    [class.active]="currentPage === totalPages"
  >
    {{ totalPages }}
  </button>
  }

  <button (click)="nextPage()" [disabled]="currentPage === totalPages">
    Siguiente
  </button>
</div>
